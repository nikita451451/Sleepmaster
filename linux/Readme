# Установка TimeMaster на Linux

Чтобы установить ваше приложение TimeMaster на Linux, выполните следующие шаги:

## 1. Установите системные зависимости:

Откройте терминал и выполните:

```bash
# Обновите пакеты
sudo apt update && sudo apt upgrade -y

# Установите Python и системные зависимости
sudo apt install python3 python3-pip python3-tk python3-pil.imagetk git -y

# Установите PolicyKit для выполнения системных команд
sudo apt install policykit-1 -y

# Установите поддержку гибернации (если не установлена)
sudo apt install pm-utils -y
```

## 2. Установите Python-зависимости:

```bash
pip3 install customtkinter pillow
```

## 3. Скачайте и подготовьте приложение:

```bash
# Клонируйте репозиторий (если есть) или создайте папку
mkdir ~/TimeMaster && cd ~/TimeMaster

# Создайте файл приложения
nano timemaster.py
```

Вставьте туда [готовый код адаптированного приложения](#) (тот полный код, что я предоставил ранее).

Затем скачайте иконку приложения для Linux:

```bash
wget https://example.com/sleep_icon.png  # Замените на реальную ссылку
# ИЛИ используйте свою иконку в формате PNG
```

## 4. Сделайте приложение исполняемым:

```bash
chmod +x timemaster.py
```

## 5. Настройте автозапуск (опционально):

Создайте desktop-файл:

```bash
nano ~/.local/share/applications/timemaster.desktop
```

Вставьте содержимое:
```ini
[Desktop Entry]
Name=TimeMaster
Comment=Планировщик включения/выключения ПК
Exec=/usr/bin/python3 /home/ваш_пользователь/TimeMaster/timemaster.py
Icon=/home/ваш_пользователь/TimeMaster/sleep_icon.png
Terminal=false
Type=Application
Categories=Utility;
StartupNotify=true
```

## 6. Убедитесь, что система готова к гибернации:

### Проверьте swap:
```bash
swapon --show
```

### Настройте файл сна:
```bash
sudo nano /etc/systemd/sleep.conf
```
Раскомментируйте строку:
```
HibernateMode=platform shutdown
```

### Добавьте права на выполнение системных команд:
```bash
sudo nano /etc/polkit-1/localauthority/50-local.d/timecore.pkla
```
Добавьте:
```ini
[Allow hibernation]
Identity=unix-user:*
Action=org.freedesktop.login1.hibernate
ResultAny=yes
ResultInactive=yes
ResultActive=yes
```

## 7. Запуск приложения:

Вы можете запускать приложение несколькими способами:

### Вручную:
```bash
cd ~/TimeMaster
python3 timemaster.py
```

### Из файлового менеджера:
Просто дважды кликните на файл `timemaster.py`

### Через меню приложений:
Найдите "TimeMaster" в главном меню вашего Linux

## 8. Решение проблем:

Если возникают проблемы с правами:
```bash
sudo nano /etc/sudoers
```
Добавьте в конец:
```
ваш_пользователь ALL=(ALL) NOPASSWD: /usr/bin/systemctl poweroff, /usr/bin/systemctl reboot, /usr/bin/systemctl suspend, /usr/bin/systemctl hibernate
```

Для проверки гибернации:
```bash
sudo systemctl hibernate
```

## Дополнительные советы:

1. Обновите приложение до системного уровня:
```bash
sudo mv ~/TimeMaster /opt/timemaster
sudo ln -s /opt/timemaster/timemaster.py /usr/local/bin/timemaster
```

2. Добавьте вход в систему без пароля для системных команд:
```bash
sudo visudo
```
Добавьте:
```
yourusername ALL=(ALL) NOPASSWD: /usr/bin/systemctl
```

3. Используйте systemd-сервис для запуска при старте системы:
```bash
sudo nano /etc/systemd/system/timemaster.service
```
Добавьте:
```ini
[Unit]
Description=TimeMaster App
After=graphical.target

[Service]
User=ваш_пользователь
WorkingDirectory=/opt/timemaster/
ExecStart=/usr/bin/python3 /opt/timemaster/timemaster.py
Restart=on-failure

[Install]
WantedBy=multi-user.target
```
Активируйте службу:
```bash
sudo systemctl daemon-reload
sudo systemctl enable timemaster.service
sudo systemctl start timemaster.service
```

## Убедитесь, что:

1. Файл иконки PNG находится в той же директории
2. У вас установлены все Python-зависимости
3. Системные команды гибернации работают через `sudo systemctl hibernate`
4. Вы настроили приложение через GUI после первого запуска

Приложение будет сохранять конфигурацию в `~/.config/timemaster/config.json`.